{% load static %}
{% load i18n %}

<!-- Navbar -->
<div class="navbar">
    <div class="logo">Streaming<span>.</span></div>
    <ul class="nav-links">
        <li><a href="{% url 'home' %}">{% trans "Home" %}</a></li>
        <link rel="stylesheet" href="{% static 'css/styles.css' %}">

        <li><a href="{% url 'streaming:logout' %}">{% trans "Logout" %}</a></li>
    </ul>
</div>

<div class="profile-container">

    <!-- Profile Card -->
    <div class="profile-card">
        <img src="{{ profile.profile_picture.url }}" alt="{% trans 'Profile Picture' %}">
        <div class="profile-info">
            <h2>{{ request.user.get_full_name|default:request.user.username }}</h2>
            <form method="post" enctype="multipart/form-data" class="profile-form">
                {% csrf_token %}
                {{ form.profile_picture }}
                <button type="submit" class="btn-small">{% trans "Update Picture" %}</button>
            </form>
        </div>
    </div>

    <!-- Stats -->
    <div class="stats-card">
        <h3>{% trans "Stats" %}</h3>
        <p><strong>{% trans "Total Videos Watched:" %}</strong> {{ total_videos }}</p>
        <p><strong>{% trans "Total Watch Time:" %}</strong> {{ total_watch_time }} {% trans "minutes" %}</p>
    </div>

    <!-- Watch History -->
    <div class="history-card">
        <h3>{% trans "Watch History" %}</h3>
        {% if watch_history %}
            <table>
                <thead>
                    <tr>
                        <th>{% trans "Video Title" %}</th>
                        <th>{% trans "Watch Date" %}</th>
                        <th>{% trans "Duration Watched" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for history in watch_history %}
                    <tr>
                        <td>{{ history.video_title }}</td>
                        <td>{{ history.watch_date|date:"M d, Y H:i" }}</td>
                        <td>{{ history.duration_watched }} {% trans "min" %}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>{% trans "No watch history found." %}</p>
        {% endif %}
    </div>

</div>
